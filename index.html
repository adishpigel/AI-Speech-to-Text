<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AITexter - תמלול אודיו חכם</title>
    <!-- גופנים ואייקונים -->
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- קובץ CSS חיצוני -->
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- סרגל עליון -->
    <header>
      <div class="logo">AITexter</div>
      <nav>
        <ul>
          <li>
            <a href="#" onclick="showPopup('languagePopup')">
              <i class="fas fa-language"></i> בחירת שפה
            </a>
          </li>
          <li>
            <a href="#" onclick="showPopup('apiKeyPopup')">
              <i class="fas fa-key"></i> הגדר API Key
            </a>
          </li>
          <li>
            <a href="#" onclick="showPopup('settingsPopup')">
              <i class="fas fa-cog"></i> הגדרות
            </a>
          </li>
          <li>
            <a href="#" onclick="showPopup('helpPopup')">
              <i class="fas fa-question-circle"></i> עזרה
            </a>
          </li>
        </ul>
        <div class="menu-toggle" onclick="toggleMenu()">
          <i class="fas fa-bars"></i>
        </div>
      </nav>
    </header>

    <!-- הודעה קופצת בעת עליית העמוד -->
    <div id="welcomePopup" class="popup">
      <div class="popup-content">
        <h2>ברוכים הבאים ל-AITexter</h2>
        <p>
          קובץ האודיו שלך יישמר בהתאם להגדרות שלך, מ'לא ישמר כלל' ועד 24 שעות.
          בכל מקרה, הקובץ יימחק אוטומטית לאחר 24 שעות.
        </p>
        <button class="control-button" onclick="closePopup('welcomePopup')">
          סגור
        </button>
      </div>
    </div>

    <!-- אזור מרכזי -->
    <main>
      <div class="container">
        <!-- אזור כתיבה -->
        <div class="text-area">
          <h2>התחל להקליט או העלה קובץ אודיו</h2>
          <!-- כפתורי בחירת מקור אודיו -->
          <div class="audio-source-buttons">
            <button class="action-button" onclick="showPopup('audioInputPopup')">
              <i class="fas fa-upload"></i> בחר מקור אודיו
            </button>
          </div>
          <!-- אזור הצגת התמלול -->
          <div class="transcription-display" id="transcriptionDisplay">
            <!-- התמלול יופיע כאן -->
          </div>
        </div>

        <!-- כפתורים עיקריים -->
        <div class="main-buttons">
          <button
            class="primary-button"
            id="transcribeButton"
            onclick="transcribe()"
          >
            <i class="fas fa-play"></i> התחל תמלול
          </button>
          <button
            class="secondary-button"
            id="cancelTranscriptionButton"
            onclick="cancelTranscription()"
            style="display: none;"
          >
            <i class="fas fa-stop"></i> עצור תמלול
          </button>
        </div>

        <!-- כפתורים נוספים -->
        <div class="additional-buttons">
          <button class="action-button" onclick="copyToClipboard()">
            <i class="fas fa-copy"></i> העתק
          </button>
          <button class="action-button" onclick="downloadFile()">
            <i class="fas fa-download"></i> הורד
          </button>
          <button class="action-button" onclick="summarizeTranscription()">
            <i class="fas fa-compress-alt"></i> סכם
          </button>
        </div>

        <!-- אזור התקדמות והודעות -->
        <div id="loader" class="loader"></div>
        <div class="progress-container" id="progressContainer">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="progress-text" id="progressText">0%</div>
        </div>

        <!-- כרטיסיות תמלול -->
        <div class="card transcription-card">
          <div class="tab-buttons">
            <button class="tab-button active" onclick="showTab('srt')">
              SRT
            </button>
            <button class="tab-button" onclick="showTab('plainText')">
              טקסט רגיל
            </button>
          </div>
          <div id="srtContent" class="tab-content active">
            <div class="transcription-container">
              <div id="srtTranscription"></div>
              <div class="transcription-fade"></div>
              <button class="expand-button" onclick="toggleTranscription(this)">
                הצג הכל
              </button>
            </div>
          </div>
          <div id="plainTextContent" class="tab-content">
            <div class="transcription-container">
              <div id="plainTextTranscription"></div>
              <div class="transcription-fade"></div>
              <button class="expand-button" onclick="toggleTranscription(this)">
                הצג הכל
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- פופאפים -->
    <!-- Popup לבחירת שפה -->
    <div id="languagePopup" class="popup">
      <div class="popup-content">
        <h2>בחר שפה לתמלול</h2>
        <select id="languageSelectMain">
          <option value="">זיהוי אוטומטי</option>
          <option value="he">עברית</option>
          <option value="en">אנגלית</option>
          <option value="ar">ערבית</option>
          <option value="ru">רוסית</option>
          <option value="fr">צרפתית</option>
          <option value="es">ספרדית</option>
          <option value="de">גרמנית</option>
        </select>
        <div class="popup-footer">
          <button class="control-button" onclick="saveLanguageSelection()">
            שמור
          </button>
          <button class="control-button" onclick="closePopup('languagePopup')">
            ביטול
          </button>
        </div>
      </div>
    </div>

    <!-- Popup להגדרת API Key -->
    <div id="apiKeyPopup" class="popup">
      <div class="popup-content">
        <h2>הגדר API Key</h2>
        <input type="text" id="apiKeyInput" placeholder="הזן API Key" />
        <br />
        <br />
        <div class="popup-footer">
          <button class="control-button" onclick="saveApiKey()">שמור</button>
          <button class="control-button" onclick="closePopup('apiKeyPopup')">
            ביטול
          </button>
        </div>
      </div>
    </div>

    <!-- Popup לבחירת מקור אודיו -->
    <div id="audioInputPopup" class="popup">
      <div class="popup-content">
        <h2>בחר מקור אודיו</h2>
        <div class="tab-buttons">
          <button class="tab-button active" onclick="showAudioTab('file')">
            העלאת קובץ
          </button>
          <button class="tab-button" onclick="showAudioTab('record')">
            הקלטה
          </button>
        </div>
        <div id="fileInputTab" class="tab-content active">
          <input
            type="file"
            id="audioFile"
            accept="audio/*"
            onchange="handleFileSelect(event)"
          />
          <!-- הוספת אפשרות לבחירת זמן שמירת הקובץ -->
          <div style="margin-top: 15px;">
            <label for="fileRetention">משך זמן שמירת הקובץ:</label>
            <select id="fileRetention">
              <option value="0">לא לשמור</option>
              <option value="1">1 שעה</option>
              <option value="2" selected>2 שעות</option>
              <option value="6">6 שעות</option>
              <option value="12">12 שעות</option>
              <option value="24">24 שעות</option>
            </select>
          </div>
        </div>
        <div id="recordInputTab" class="tab-content">
          <button
            id="recordButton"
            class="control-button"
            onclick="toggleRecording()"
          >
            <i class="fas fa-microphone"></i> התחל הקלטה
          </button>
          <div id="recordingStatus" style="display: none">
            <p>יש הקלטה בזיכרון</p>
            <button class="control-button" onclick="deleteRecording()">
              מחק הקלטה
            </button>
          </div>
          <!-- הוספת אפשרות לבחירת זמן שמירת הקובץ -->
          <div style="margin-top: 15px;">
            <label for="recordRetention">משך זמן שמירת הקובץ:</label>
            <select id="recordRetention">
              <option value="0">לא לשמור</option>
              <option value="1">1 שעה</option>
              <option value="2" selected>2 שעות</option>
              <option value="6">6 שעות</option>
              <option value="12">12 שעות</option>
              <option value="24">24 שעות</option>
            </select>
          </div>
        </div>
        <div class="popup-footer">
          <button class="control-button" onclick="confirmAudioInput()">
            אישור
          </button>
          <button
            class="control-button"
            onclick="closePopup('audioInputPopup')"
          >
            ביטול
          </button>
        </div>
      </div>
    </div>

    <!-- Popup להגדרות -->
    <div id="settingsPopup" class="popup">
      <div class="popup-content">
        <h2>הגדרות</h2>
        <div style="margin-bottom: 15px;">
          <label for="wordsPerSubtitle">מילים בכל כתובית:</label>
          <select id="wordsPerSubtitle">
            <option value="4">4</option>
            <option value="6">6</option>
            <option value="8" selected>8</option>
            <option value="10">10</option>
            <option value="12">12</option>
          </select>
        </div>
        <div class="popup-footer">
          <button class="control-button" onclick="saveSettings()">שמור</button>
          <button class="control-button" onclick="closePopup('settingsPopup')">
            ביטול
          </button>
        </div>
      </div>
    </div>

    <!-- Popup לעזרה -->
    <div id="helpPopup" class="popup">
      <div class="popup-content">
        <h2>עזרה</h2>
        <h3>איך להוציא מפתח API:</h3>
        <ol>
          <li>
            היכנסו לאתר
            <a href="https://console.groq.com" target="_blank"
              >console.groq.com</a
            >
          </li>
          <li>הירשמו או התחברו לחשבון</li>
          <li>לחצו על "Create API Key"</li>
          <li>העתיקו את המפתח שנוצר</li>
        </ol>
        <h3>איך להשתמש באתר:</h3>
        <ol>
          <li>הזינו את מפתח ה-API</li>
          <li>בחרו קובץ אודיו או הקליטו ישירות באתר</li>
          <li>בחרו את משך זמן שמירת הקובץ</li>
          <li>לחצו על "התחל תמלול"</li>
          <li>המתינו לתוצאות ובחרו בין פורמט SRT לטקסט רגיל</li>
        </ol>
        <button class="close-button" onclick="closePopup('helpPopup')">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>

    <!-- Popup לסיכום התמלול -->
    <div id="summaryPopup" class="popup">
      <div class="popup-content">
        <h2>סיכום התמלול</h2>
        <div id="summaryContent"></div>
        <div class="popup-footer">
          <button class="control-button" onclick="downloadSummary()">
            <i class="fas fa-download"></i> הורד סיכום
          </button>
          <button class="control-button" onclick="closePopup('summaryPopup')">
            סגור
          </button>
        </div>
      </div>
    </div>

    <!-- קובץ JavaScript חיצוני -->
    <script src="script.js"></script>
  </body>
</html>
